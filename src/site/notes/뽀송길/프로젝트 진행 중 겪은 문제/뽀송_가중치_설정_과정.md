---
{"dg-publish":true,"permalink":"/뽀송길/프로젝트 진행 중 겪은 문제/뽀송_가중치_설정_과정/","created":"2024-09-25T12:40:10.736+09:00"}
---

# 가중치 요소 정하기
[[뽀송길/프로젝트 진행 중 겪은 문제/서울시_지리공간_데이터_만들기\|서울시_지리공간_데이터_만들기]]와 [[뽀송길/프로젝트 진행 중 겪은 문제/OSRM_실행과정_일대기\|OSRM_실행과정_일대기]]를 거쳐 OSRM을 도입했으니, 이제 비를 덜 맞는 대중교통 경로 탐색을 위해 가중치를 조절해야 했다. 가중치 조절 요소로 다음과 같은 것들이 떠올랐다.
### 가중치 요소 후보
#### 1. 교통사고가 덜 일어난 도로
- 교통사고 이력 데이터를 기반으로, 사고가 자주 발생하는 지역이나 도로를 피할 수 있다.
- 사고가 적은 경로를 탐색하여 안전한 도로와 보행로를 우선 선택할 수 있다.
#### 2. 큰길 우선
- 우산으로 인해 시야 제한되면서 차량 발견 못할 확률이 높다.
- 골목길은 큰 길에 비해 도로 품질이 낮을 수 있으며 인도, 가로등이 없을 수 있다.
- 큰길에 비해 골목길에서는 보행자와 차량 사이 거리가 가까워서 물이 튈 확률이 높다.
#### 3. 경사로 낮은 길
- 비가 올 때 경사가 있으면 도보 속도가 더 느려져 비에 더 많은 영향을 받는다.
- 비가 올 때 경사도 있는 길은 미끄러워 위험하다.
#### 4. 건널목이 적은 길
- 횡단보도 대기 시간 때문에 비를 더 많이 맞을 수 있다.
- 횡단보도 주변에서 교통사고가 많이 발생한다.
#### 5. 비를 막아주는 구조물이 있는 길
- 비를 완전히 막아주는 구조물이 있는 길
- 비를 일부 막아주는 구조물이 있는 길
##### 가중치 요소 후보로 제시한 1 ~ 4  요소들은 =='비' 보다 '안전'에 중점==을 둔 것으로 판단되었으며, 이 요소들로 가중치를 조절하여 보행자가 비에 덜 노출되더라도, 그 정도가 미미하다고 판단되어 탈락했다.
### 비를 막아주는 구조물
비가 오는 날 실질적으로 도움이 되는 도로는 비를 막아주는 구조물이 있는 도로이다. 따라서 구조물을 가중치 요소로 설정했으며, 터널처럼 비를 완전히 막아주는 구조물과 지붕, 천막처럼 일부만 막아주는 구조물의 차단 정도가 다르기 때문에 가중치를 차등 적용하기로 했다. JOSM을 통해 서울시 지리공간 데이터의 태그들을 확인한 결과 비를 완전히 막아주는 터널(tunnel) 속성을 가진 보행자 도로는 697개, 비를 일부 막아주는 건물 통로, 지붕, 천막 등의 구조물로 표시된 covered 속성을 가진 보행자 도로는 592개가 있었다.![](https://i.imgur.com/kYf5CRu.png)
___
# 가중치 조절 과정
### 가중치 기준 정하기
OSRM에서 경로를 탐색할 때, 가중치로는 `routability`, `duration`, `distance를` 선택할 수 있다.([링크](https://github.com/Telenav/open-source-spec/blob/master/osrm/doc/how_osrm_calculate_weight_and_duration.md))
- `routability` : 소요 시간을 기준으로 하되, 특정 도로를 선호하도록 가중치를 부여한 라우팅
- `duration` : 특정 도로 접근에 대한 패널티 없이 가장 짧은 소요시간을 기준으로 한 라우팅
- `distance` : 특정 도로 접근에 대한 패널티 없이 가장 짧은 거리를 기준으로 한 라우팅
`routability`는 `OSRM`에서 설정한 특정 도로의 선호도에 영향을 받기 때문에 이를 피하고자 제외했다.  가중치로 `distance`를 선택할 경우, 사용자에게 실제 거리를 안내해야 하는데 거리를 조정하는 과정에서 왜곡이 생길 수 있다고 판단했다. 물론 `duration`을 선택해도 소요 시간을 조정해야 해서 왜곡이 발생할 수 있지만, 소요시간은 `소요시간 = 거리 / 속도`로 간단히 계산할 수 있기 때문에 가중치로 `duration`을 선택했다. 또한, 도로별 속도를 직접 설정하여 특정 도로에 대한 선호도를 자체적으로 관리하기로 했다.
### 가중치 실험을 위한 테스트 케이스 정하기
- #### tunnel
	-  숭실대학교 → 청년짬뽕국밥집
		- 청년짬뽕국밥집은 tunnel 속성을 가진 광장시장 내에 위치하고 있다.
	- 
- #### covered
	- 숭실대학교 → 호스텔제이스테이
		- 호스텔제이스테이는 covered 속성을 가진 중부 시장 내에 위치하고 있다.
	- 서울경찰청 → 서린정보기술 본사
		- 서린정보기술 본사는 covered 속성을 가진 피마길에 위치하고 있다.
### 잘못된 가중치 설정으로 인한 비효율적인 경로
### 최종 가중치
---
# 결과
---
# 회고
